//traverser.sync
var curry = require('curry')
  , sync = require('./iterators').sync

exports = module.exports = traverse
exports.isObject = isObject
exports.isComplex = isComplex

function isObject (props){
  return ('object' === typeof props.value)
}

var complex =
  { 'function': true
  , 'object': true
  , 'string': false
  , 'boolean': false
  , 'number': false
  , 'undefined': false
}
function isComplex (props){
  return props.value && complex[typeof props.value]
}

function traverse (object,opts){

  if('function' == typeof opts)
    opts = {each: opts}

  if (opts.each)
    opts.leaf = opts.branch = opts.each
  if(!opts.leaf)
    opts.leaf = function (p){return p.value}
  if(!opts.branch)
    opts.branch = function (p){return p.iterate()}

  if(!opts.isBranch)
    opts.isBranch = exports.isObject

  if('string' == typeof opts.iterator){
    var s = opts.iterator
    opts.iterator = sync[s]
    
    if (!opts.iterator)
      throw new Error('\'' + s + '\' is not the name of a traverse iterator.'
      