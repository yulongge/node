'use strict';
var assert = require('assert');
var inherits = require('util').inherits;
var EventEmitter = require('events').EventEmitter;

inherits(Test, EventEmitter);

function Test(title, fn) {
	if (typeof title !== 'string') {
		fn = title;
		title = null;
	}

	this.title = title || fn.name || '[anonymous]';
	this._fn = fn;
	this._plan = null;
	this._skip = false;
	this._assertCount = 0;
	this._assertError = null;
	this._endCalled = false;
	this._ended = false;
}

Test.prototype.end = function () {
	if 